<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="OpenMLS"><meta name="keywords" content="rust, rustlang, rust-lang, openmls"><title>openmls - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../openmls/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../openmls/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Crate openmls</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.4.1</li><li><a id="all-types" href="all.html">All Items</a></li></ul></div><section><div class="block"><ul><li><a href="#modules">Modules</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../openmls/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><div id="settings-menu" tabindex="-1">
                                <a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">openmls</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/openmls/lib.rs.html#1-179">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="openmls"><a href="#openmls">OpenMLS</a></h2>
<p><a href="https://openmls.zulipchat.com"><img src="https://img.shields.io/badge/zulip-join_chat-blue.svg?style=for-the-badge&amp;logo=zulip" alt="OpenMLS Chat" /></a>
<a href="https://groups.google.com/u/0/g/openmls-dev"><img src="https://img.shields.io/badge/mailing-list-blue.svg?style=for-the-badge" alt="OpenMLS List" /></a></p>
<p><a href="https://github.com/openmls/openmls/actions/workflows/tests.yml"><img src="https://img.shields.io/github/workflow/status/openmls/openmls/Tests/main?label=Tests&amp;style=for-the-badge&amp;logo=github" alt="Tests &amp; Checks" /></a>
<a href="https://cloud.drone.io/openmls/openmls"><img src="https://img.shields.io/drone/build/openmls/openmls/main?label=ARM64%20Build%20Status&amp;logo=drone&amp;style=for-the-badge" alt="ARM64 Build Status" /></a>
<a href="https://codecov.io/gh/openmls/openmls"><img src="https://img.shields.io/codecov/c/github/openmls/openmls/main?logo=codecov&amp;style=for-the-badge" alt="codecov" /></a></p>
<p><a href="https://docs.rs/crate/openmls/latest"><img src="https://img.shields.io/badge/docs-release-blue.svg?style=for-the-badge" alt="Docs" /></a>
<a href="https://openmls.tech/book"><img src="https://img.shields.io/badge/book-release-blue.svg?style=for-the-badge" alt="Book" /></a>
<img src="https://img.shields.io/badge/rustc-1.56+-blue.svg?style=for-the-badge&amp;logo=rust" alt="Rust Version" /></p>
<p><em>OpenMLS</em> is a Rust implementation of <a href="https://github.com/mlswg/mls-protocol/blob/master/draft-ietf-mls-protocol.md">Messaging Layer Security</a> based on draft 12+.</p>
<!-- The introduction of the book imports the lines up until here (line 14), excluding the headline and separately the lines below (starting from line 20). If the line numbers change here, please modify the imported lines in the book.-->
<p>It is a software library that can serve as a building block in applications that require end-to-end encryption of messages.
It has a safe and easy-to-use interface that hides the complexity of the underlying cryptographic operations.</p>
<h3 id="supported-ciphersuites"><a href="#supported-ciphersuites">Supported ciphersuites</a></h3>
<ul>
<li>MLS10_128_HPKEX25519_AES128GCM_SHA256_Ed25519 (MTI)</li>
<li>MLS10_128_DHKEMP256_AES128GCM_SHA256_P256</li>
<li>MLS10_128_HPKEX25519_CHACHA20POLY1305_SHA256_Ed25519</li>
</ul>
<h3 id="supported-platforms"><a href="#supported-platforms">Supported platforms</a></h3>
<p>OpenMLS is built and tested on the Github CI for the following rust targets.</p>
<ul>
<li>x86_64-unknown-linux-gnu</li>
<li>i686-unknown-linux-gnu</li>
<li>x86_64-pc-windows-msvc</li>
<li>i686-pc-windows-msvc</li>
<li>x86_64-apple-darwin</li>
</ul>
<p>Additionally, we’re building and testing aarch64-unknown-linux-gnu on
<a href="https://cloud.drone.io/openmls/openmls">drone.io</a>.</p>
<p>The Github CI also builds (but doesn’t test) the following rust targets.</p>
<ul>
<li>aarch64-apple-darwin</li>
<li>aarch64-unknown-linux-gnu</li>
<li>aarch64-linux-android</li>
<li>aarch64-apple-ios</li>
<li>aarch64-apple-ios-sim</li>
<li>wasm32-unknown-unknown</li>
<li>armv7-linux-androideabi</li>
<li>x86_64-linux-android</li>
<li>i686-linux-android</li>
</ul>
<p>OpenMLS supports 32 bit platforms and above.</p>
<h3 id="cryptography-dependencies"><a href="#cryptography-dependencies">Cryptography Dependencies</a></h3>
<p>OpenMLS does not implement its own cryptographic primitives. Instead, it relies
on existing implementations of the cryptographic primitives used by MLS. There
are two different cryptography backends implemented right now. But consumers
can bring their own implementation. See <a href="https://github.com/openmls/openmls/tree/main/traits">traits</a> for more
details.</p>
<h3 id="working-on-openmls"><a href="#working-on-openmls">Working on OpenMLS</a></h3>
<p>For more details when working on OpenMLS itself please see the <a href="https://github.com/openmls/openmls/blob/main/Developer.md">Developer.md</a>.</p>
<h3 id="quick-start"><a href="#quick-start">Quick Start</a></h3>
<p>For a quick start to learn how OpenMLS works here’s the basic code to set
up to parties and have them create a group.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">openmls::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">openmls_rust_crypto</span>::{<span class="ident">OpenMlsRustCrypto</span>};

<span class="comment">// Define cipher suite ...</span>
<span class="kw">let</span> <span class="ident">ciphersuite</span> <span class="op">=</span> <span class="ident">Ciphersuite::MLS_128_DHKEMX25519_AES128GCM_SHA256_Ed25519</span>;
<span class="comment">// ... and the crypto backend to use.</span>
<span class="kw">let</span> <span class="ident">backend</span> <span class="op">=</span> <span class="kw-2">&amp;</span><span class="ident">OpenMlsRustCrypto::default</span>();

<span class="comment">// Now let&#39;s create two participants.</span>

<span class="comment">// A helper to create and store credentials.</span>
<span class="kw">fn</span> <span class="ident">generate_credential_bundle</span>(
    <span class="ident">identity</span>: <span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">u8</span><span class="op">&gt;</span>,
    <span class="ident">credential_type</span>: <span class="ident">CredentialType</span>,
    <span class="ident">signature_algorithm</span>: <span class="ident">SignatureScheme</span>,
    <span class="ident">backend</span>: <span class="kw-2">&amp;</span><span class="kw">impl</span> <span class="ident">OpenMlsCryptoProvider</span>,
) -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span><span class="ident">Credential</span>, <span class="ident">CredentialError</span><span class="op">&gt;</span> {
    <span class="kw">let</span> <span class="ident">credential_bundle</span> <span class="op">=</span>
        <span class="ident">CredentialBundle::new</span>(<span class="ident">identity</span>, <span class="ident">credential_type</span>, <span class="ident">signature_algorithm</span>, <span class="ident">backend</span>)<span class="question-mark">?</span>;
    <span class="kw">let</span> <span class="ident">credential_id</span> <span class="op">=</span>  <span class="ident">credential_bundle</span>.<span class="ident">credential</span>()
        .<span class="ident">signature_key</span>()
        .<span class="ident">tls_serialize_detached</span>()
        .<span class="ident">expect</span>(<span class="string">&quot;Error serializing signature key.&quot;</span>);
    <span class="comment">// Store the credential bundle into the key store so OpenMLS has access</span>
    <span class="comment">// to it.</span>
    <span class="ident">backend</span>
        .<span class="ident">key_store</span>()
        .<span class="ident">store</span>(<span class="kw-2">&amp;</span><span class="ident">credential_id</span>, <span class="kw-2">&amp;</span><span class="ident">credential_bundle</span>)
        .<span class="ident">expect</span>(<span class="string">&quot;An unexpected error occurred.&quot;</span>);
    <span class="prelude-val">Ok</span>(<span class="ident">credential_bundle</span>.<span class="ident">into_parts</span>().<span class="number">0</span>)
}

<span class="comment">// A helper to create key package bundles.</span>
<span class="kw">fn</span> <span class="ident">generate_key_package_bundle</span>(
    <span class="ident">ciphersuites</span>: <span class="kw-2">&amp;</span>[<span class="ident">Ciphersuite</span>],
    <span class="ident">credential</span>: <span class="kw-2">&amp;</span><span class="ident">Credential</span>,
    <span class="ident">backend</span>: <span class="kw-2">&amp;</span><span class="kw">impl</span> <span class="ident">OpenMlsCryptoProvider</span>,
) -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span><span class="ident">KeyPackage</span>, <span class="ident">KeyPackageBundleNewError</span><span class="op">&gt;</span> {
    <span class="comment">// Fetch the credential bundle from the key store</span>
    <span class="kw">let</span> <span class="ident">credential_id</span> <span class="op">=</span> <span class="ident">credential</span>
        .<span class="ident">signature_key</span>()
        .<span class="ident">tls_serialize_detached</span>()
        .<span class="ident">expect</span>(<span class="string">&quot;Error serializing signature key.&quot;</span>);
    <span class="kw">let</span> <span class="ident">credential_bundle</span> <span class="op">=</span> <span class="ident">backend</span>
        .<span class="ident">key_store</span>()
        .<span class="ident">read</span>(<span class="kw-2">&amp;</span><span class="ident">credential_id</span>)
        .<span class="ident">expect</span>(<span class="string">&quot;An unexpected error occurred.&quot;</span>);

    <span class="comment">// Create the key package bundle</span>
    <span class="kw">let</span> <span class="ident">key_package_bundle</span> <span class="op">=</span>
        <span class="ident">KeyPackageBundle::new</span>(<span class="ident">ciphersuites</span>, <span class="kw-2">&amp;</span><span class="ident">credential_bundle</span>, <span class="ident">backend</span>, <span class="macro">vec!</span>[])<span class="question-mark">?</span>;

    <span class="comment">// Store it in the key store</span>
    <span class="kw">let</span> <span class="ident">key_package_id</span> <span class="op">=</span> <span class="ident">key_package_bundle</span>.<span class="ident">key_package</span>()
            .<span class="ident">hash_ref</span>(<span class="ident">backend</span>.<span class="ident">crypto</span>())
            .<span class="ident">expect</span>(<span class="string">&quot;Could not hash KeyPackage.&quot;</span>);
    <span class="ident">backend</span>
        .<span class="ident">key_store</span>()
        .<span class="ident">store</span>(<span class="ident">key_package_id</span>.<span class="ident">value</span>(), <span class="kw-2">&amp;</span><span class="ident">key_package_bundle</span>)
        .<span class="ident">expect</span>(<span class="string">&quot;An unexpected error occurred.&quot;</span>);
    <span class="prelude-val">Ok</span>(<span class="ident">key_package_bundle</span>.<span class="ident">into_parts</span>().<span class="number">0</span>)
}

<span class="comment">// First they need credentials to identify them</span>
<span class="kw">let</span> <span class="ident">sasha_credential</span> <span class="op">=</span> <span class="ident">generate_credential_bundle</span>(
    <span class="string">&quot;Sasha&quot;</span>.<span class="ident">into</span>(),
    <span class="ident">CredentialType::Basic</span>,
    <span class="ident">ciphersuite</span>.<span class="ident">signature_algorithm</span>(),
    <span class="ident">backend</span>,
)
.<span class="ident">expect</span>(<span class="string">&quot;An unexpected error occurred.&quot;</span>);

<span class="kw">let</span> <span class="ident">maxim_credential</span> <span class="op">=</span> <span class="ident">generate_credential_bundle</span>(
    <span class="string">&quot;Maxim&quot;</span>.<span class="ident">into</span>(),
    <span class="ident">CredentialType::Basic</span>,
    <span class="ident">ciphersuite</span>.<span class="ident">signature_algorithm</span>(),
    <span class="ident">backend</span>,
)
.<span class="ident">expect</span>(<span class="string">&quot;An unexpected error occurred.&quot;</span>);

<span class="comment">// Then they generate key packages to facilitate the asynchronous handshakes</span>
<span class="comment">// in MLS</span>

<span class="comment">// Generate KeyPackages</span>
<span class="kw">let</span> <span class="ident">sasha_key_package</span> <span class="op">=</span> <span class="ident">generate_key_package_bundle</span>(<span class="kw-2">&amp;</span>[<span class="ident">ciphersuite</span>], <span class="kw-2">&amp;</span><span class="ident">sasha_credential</span>, <span class="ident">backend</span>)
    .<span class="ident">expect</span>(<span class="string">&quot;An unexpected error occurred.&quot;</span>);

<span class="kw">let</span> <span class="ident">maxim_key_package</span> <span class="op">=</span> <span class="ident">generate_key_package_bundle</span>(<span class="kw-2">&amp;</span>[<span class="ident">ciphersuite</span>], <span class="kw-2">&amp;</span><span class="ident">maxim_credential</span>, <span class="ident">backend</span>)
    .<span class="ident">expect</span>(<span class="string">&quot;An unexpected error occurred.&quot;</span>);

<span class="comment">// Now Sasha starts a new group ...</span>
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">sasha_group</span> <span class="op">=</span> <span class="ident">MlsGroup::new</span>(
    <span class="ident">backend</span>,
    <span class="kw-2">&amp;</span><span class="ident">MlsGroupConfig::default</span>(),
    <span class="ident">GroupId::from_slice</span>(<span class="string">b&quot;My First Group&quot;</span>),
    <span class="ident">sasha_key_package</span>
        .<span class="ident">hash_ref</span>(<span class="ident">backend</span>.<span class="ident">crypto</span>())
        .<span class="ident">expect</span>(<span class="string">&quot;Could not hash KeyPackage.&quot;</span>)
        .<span class="ident">as_slice</span>(),
)
.<span class="ident">expect</span>(<span class="string">&quot;An unexpected error occurred.&quot;</span>);

<span class="comment">// ... and invites Maxim.</span>
<span class="comment">// The key package has to be retrieved from Maxim in some way. Most likely</span>
<span class="comment">// via a server storing key packages for users.</span>
<span class="kw">let</span> (<span class="ident">mls_message_out</span>, <span class="ident">welcome</span>) <span class="op">=</span> <span class="ident">sasha_group</span>
    .<span class="ident">add_members</span>(<span class="ident">backend</span>, <span class="kw-2">&amp;</span>[<span class="ident">maxim_key_package</span>])
    .<span class="ident">expect</span>(<span class="string">&quot;Could not add members.&quot;</span>);

<span class="comment">// Sasha merges the pending commit that adds Maxim.</span>
<span class="ident">sasha_group</span>
   .<span class="ident">merge_pending_commit</span>()
   .<span class="ident">expect</span>(<span class="string">&quot;error merging pending commit&quot;</span>);

<span class="comment">// Now Maxim can join the group.</span>
 <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">maxim_group</span> <span class="op">=</span> <span class="ident">MlsGroup::new_from_welcome</span>(
    <span class="ident">backend</span>,
    <span class="kw-2">&amp;</span><span class="ident">MlsGroupConfig::default</span>(),
    <span class="ident">welcome</span>,
    <span class="comment">// The public tree is need and transferred out of band.</span>
    <span class="comment">// It is also possible to use the [`RatchetTreeExtension`]</span>
    <span class="prelude-val">Some</span>(<span class="ident">sasha_group</span>.<span class="ident">export_ratchet_tree</span>()),
 )
 .<span class="ident">expect</span>(<span class="string">&quot;Error joining group from Welcome&quot;</span>);</code></pre></div>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="ciphersuite/index.html" title="openmls::ciphersuite mod">ciphersuite</a></div><div class="item-right docblock-short"><p>Ciphersuites for MLS</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="credentials/index.html" title="openmls::credentials mod">credentials</a></div><div class="item-right docblock-short"><p>Credentials</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="error/index.html" title="openmls::error mod">error</a></div><div class="item-right docblock-short"><p>OpenMLS Errors</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="extensions/index.html" title="openmls::extensions mod">extensions</a></div><div class="item-right docblock-short"><p>Extensions</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="framing/index.html" title="openmls::framing mod">framing</a></div><div class="item-right docblock-short"><p>Message framing</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="group/index.html" title="openmls::group mod">group</a></div><div class="item-right docblock-short"><p>Group API for MLS</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="key_packages/index.html" title="openmls::key_packages mod">key_packages</a></div><div class="item-right docblock-short"><p>Key Packages</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="messages/index.html" title="openmls::messages mod">messages</a></div><div class="item-right docblock-short"><p>Messages</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="prelude/index.html" title="openmls::prelude mod">prelude</a></div><div class="item-right docblock-short"><p>Single place, re-exporting the most used public functions.
Prelude for OpenMLS.
Include this to get access to all the public functions of OpenMLS.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="schedule/index.html" title="openmls::schedule mod">schedule</a></div><div class="item-right docblock-short"><p>Key schedule</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="treesync/index.html" title="openmls::treesync mod">treesync</a></div><div class="item-right docblock-short"><p>This module implements the ratchet tree component of MLS.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="versions/index.html" title="openmls::versions mod">versions</a></div><div class="item-right docblock-short"><p>MLS versions</p>
</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="openmls" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.63.0 (4b91a6ea7 2022-08-08)" ></div>
</body></html>